module types-subinterface

language Java

start symbol File

setup [[
	interface IA {}
	interface IB extends IA {}
	interface IC extends IB {}
	interface ID {}
	interface IE extends ID, IA {}
	
]]

test subinterface assignment [[
	class Test {
		void m() {
			IA a = new IA();
			IB b = new IB();
			IC c = new IC();
			ID d = new ID();
			IE e = new IE();
			
			a = b;
			a = c;
			a = e;
			b = c;
			d = e;
		}
	}
]] 0 errors

test subinterface assignment fails [[
	class Test {
		void m() {
			IA a = new IA();
			IB b = new IB();
			IC c = new IC();
			ID d = new ID();
			IE e = new IE();
			
			[[c = b]];
			[[c = a]];
			[[b = a]];
			[[e = d]];
			
			[[a = d]];
			[[b = d]];
			[[c = d]];
		}
	}
]] 7 errors

test subinterface casting [[
	class Test {
		void m() {
			IA a = new IA();
			IB b = new IB();
			IC c = new IC();
			ID d = new ID();
			IE e = new IE();
			
			(IB)a;
			(IC)a;
			(IC)b;
			(IE)a;
			(IE)d;
			
			(IA)c;
			(IA)b;
			(IB)c;
			(IA)e;
			(ID)e;
		}
	}
]] 0 errors

// TODO: generate errors for cyclic subinterfacing
// test cyclic subinterfaceing [[
// 	interface ID extends E {}
// 	interface E extends ID {}
// 	
// 	interface Test {
// 		void m() {
// 			ID d = new ID();
// 			E e = new E();
// 			
// 			e = d;
// 			d = e;
// 		}
// 	}
// ]] 4 errors
