module types-subclass

language Java

start symbol File

setup [[
	class A {}
	class B extends A {}
	class C extends B {}
	class D {}
	
]]

test subclass assignment [[
	class Test {
		void m() {
			A a = new A();
			B b = new B();
			C c = new C();
			
			a = b;
			a = c;
		}
	}
]] 0 errors

test subclass assignment fails [[
	class Test {
		void m() {
			A a = new A();
			B b = new B();
			C c = new C();
			D d = new D();
			
			[[c = b]];
			[[c = a]];
			[[b = a]];
			
			[[a = d]];
			[[b = d]];
			[[c = d]];
		}
	}
]] 6 errors

test subclass casting [[
	class Test {
		void m() {
			A a = new A();
			B b = new B();
			C c = new C();
			
			(B)a;
			(C)a;
			(C)b;
			
			(A)c;
			(B)c;
			(A)b;
		}
	}
]] 0 errors

// TODO: generate errors for cyclic subtyping
// test cyclic subclassing [[
// 	class D extends E {}
// 	class E extends D {}
// 	
// 	class Test {
// 		void m() {
// 			D d = new D();
// 			E e = new E();
// 			
// 			e = d;
// 			d = e;
// 		}
// 	}
// ]] 4 errors
